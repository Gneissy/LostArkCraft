<%# Including header partial %>
<%- include("partials/header"); -%>


<div class="row">
  <div class="tradeItemsColumn col-lg-6 col-md-12 col-sm-12">
    <table>

      <tr>
        <td>img</td>
        <td class= "item-name">Item Name</td>
        <td class="cell" >Bundle</td>
        <td class="cell" >Price</td>
        <td class="cell" >Last Update:</td>
        <td class="cell" >Set new price:</td>
      </tr>

    <% tradeItemDisplayed.slice().forEach(function(tradeItemDisplayed){ %> <!-- This allows us to loop all raws -->
      <tr class= "rarity-<%= tradeItemDisplayed.rarity %>"> <!-- This includes background color correspoding to rarity -->
        <td>
          <div class="img">
            <img class = "item-image" src="images/<%= tradeItemDisplayed.name %>.png" alt="ex"> <!-- This allows me to assign images according to trade item name -->
          </div>
        </td>
        <td class= "item-name"><%= tradeItemDisplayed.name %></td> <!-- This is the object's name -->
        <td class="cell" ><%= tradeItemDisplayed.bundle %></td> <!-- This is the object's bundle value (10-100) -->
        <!-- This is the item's current price value. We are able to change it on the way. -->
        <td class="cell" ><%= tradeItemDisplayed.price %> <span><img class="gold-image" src="images/gold-image.png" alt="gold-image"></span></td>
        <td class="cell-lastUpdate"><%= date1.from(tradeItemDisplayed.lastUpdate)  %></td>

        <td>
          <!-- This form allows me to change the item's price value. -->
          <form id= "myForm" action="/<%= selectedType %>/change" method="post">

            <!-- This is the price input that will be updated -->
            <input class = "setPrice" type="text" name="newPrice" autocomplete="off">

            <!-- VERY IMPORTANT! This hidden input allows me to get the ID of corresponding item -->
            <!-- We fetch the id with "req.body.specificItem" -->
            <!-- TradeItemDisplayed is tradeItems that was found via "TradeItem.find({})" -->
            <!-- Means each tradeItemDisplayed is one object in the database -->
            <input type="hidden" name="specificItem" value="<%= tradeItemDisplayed._id %>">

            <!-- Action happens when the submit button is pressed -->
            <button class="btn uniqueSubmitButton" type="submit" name="submitButton">âœ”</button>
          </form>
        </td>
      </tr>
    <% }); %>
    </table>

  </div>
  <div class="otherColumn col-lg-6 col-md-12 col-sm-12">
    <div class="dropdown">
      <button onclick="toggleTradeItems()" class="dropbtn">Select trade item type</button>
      <div id="tradeDropdown" class="dropdown-content">
        <a href="/">All</a>
        <a href="/foraging">Foraging</a>
        <a href="/logging">Logging</a>
        <a href="/mining">Mining</a>
        <a href="/hunting">Hunting</a>
        <a href="/fishing">Fishing</a>
        <a href="/excavating">Excavating</a>
      </div>
    </div>

    <div class="dropdown">
      <button onclick="toggleBattleItems()" class="dropbtn">Select battle item type</button>
      <div id="battleDropdown" class="dropdown-content">
        <a href="/">All</a>
        <a href="/recovery">Recovery</a>
        <a href="/offense">Offense</a>
        <a href="/utility">Utility</a>
        <a href="/buff">Buff</a>

      </div>
    </div>
  </div>
</div>

<%# Including footer partial %>
<%- include("partials/footer"); -%>
